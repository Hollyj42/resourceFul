<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecturer Dashboard</title>
    <link rel="stylesheet" href="../css/dashboard.css">
</head>
<body>
    
    <div class="heading">
        <button id="uploadSymbol">Upload <img class="uploadSymbol" src="../images/document.png" alt="Upload Symbol"/></button>
        <button id="logoutButton" class="logout">Log out</button> 
    </div>

    <div class="upload-container">
        <h2>Upload New Document</h2>

        <form action="/upload" method="POST" enctype="multipart/form-data" id="uploadForm">
            
            <label for="title">Course Title/Number:</label>
            <input type="text" id="title" name="title" required><br>

            <label for="course">Course Name:</label>
            <input type="text" id="course" name="course" required><br>
            
            <label for="documentFile">Select File:</label>
            <input type="file" id="documentFile" name="documentFile" required><br>
            
            <button type="submit" id="submitUpload">Submit Document</button>
        </form>
    </div>

    <div class="uploadedDocList"> 
        <h3>YOUR UPLOADED DOCUMENTS</h3>
        
        <ul id="lecturerDocumentsList"></ul>
    </div>
    
    <script>
    // --- 1. LOGOUT FUNCTION ---
    function handleLogout() {
        // Clear any stored local data (good practice, though not strictly necessary without server sessions)
        localStorage.clear(); 
        sessionStorage.clear(); 

        // Redirect the user to the login page
        window.location.href = '../html/login.html'; 
    }
    
    // --- 2. FUNCTION TO LOAD DOCUMENTS (Existing Logic) ---
    function loadLecturerDocuments() {
        fetch('/api/courses')
            .then(response => response.json())
            .then(documents => {
                const docList = document.getElementById('lecturerDocumentsList');
                docList.innerHTML = ''; 
                
                documents.forEach(doc => {
                    const listItem = document.createElement('li');
                    
                    // Display details using innerHTML for better styling
                    listItem.innerHTML = `
                        <span><strong>Course:</strong> ${doc.course}</span>
                        <span><strong>Course No:</strong> ${doc.title}</span>
                    `; 
                    
                    docList.appendChild(listItem);
                });
            })
            .catch(error => {
                console.error('Error fetching lecturer documents:', error);
                const docList = document.getElementById('lecturerDocumentsList');
                docList.innerHTML = '<li>Error loading documents. Please check the server connection.</li>';
            });
    }

    // --- 3. EVENT LISTENERS (Runs when the page is ready) ---
    document.addEventListener('DOMContentLoaded', function() {
        // Upload form toggle logic
        const uploadButton = document.getElementById('uploadSymbol');
        const formContainer = document.querySelector('.upload-container');

        if (uploadButton && formContainer) {
            uploadButton.addEventListener('click', function() {
                if (formContainer.style.display === 'block') {
                    formContainer.style.display = 'none';
                } else {
                    formContainer.style.display = 'block';
                }
            });
        }
        
        // LOGOUT BUTTON LISTENER
        const logoutBtn = document.getElementById('logoutButton');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', handleLogout); // Calls the function on click
        }
    });

    // --- 4. INITIALIZE PAGE DATA ---
    window.onload = loadLecturerDocuments;

    </script>
</body>
</html>